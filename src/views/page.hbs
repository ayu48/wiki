<!DOCTYPE html>
    {{> head}}
    <body>
        {{> nav_bar}}
        <div class="container">
            <div class="page-header">
                <h1>{{{page.title}}}</h1>
            </div>
            <p class="text-muted">
                Created : {{time page.ctime}}
                &nbsp;&nbsp;&nbsp;&nbsp;
                Updated : {{time page.mtime}}
            </p>

            {{#marked}}{{page.content}}{{/marked}}

            <p class="bs-component">
                <a href="/page/edit/{{page._id}}" class="btn btn-default">Edit</a>
                <button page-id="{{page._id}}" class="btn btn-danger js-delete-page">Delete</button>
            </p>
        </div>
        <script>
            $(document).ready(function() {
                $('.js-delete-page').click(function(event) {
                    if (confirm("Are you sure you want to delete this page?")) {
                        $target = $(event.target);
                        $.ajax({
                            url: '/page/' + $target.attr('page-id'),
                            type: 'DELETE'
                        }).done(function() {
                            window.location = '/';
                        }).fail(function() {
                            //TODO: failhandler
                        });
                    }
                });
            });
        </script>
    </body>
</html>
